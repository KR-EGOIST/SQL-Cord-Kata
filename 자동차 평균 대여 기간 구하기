/*
조회 : SELECT
반올림 : ROUND(값, 자릿수)
평균 : AVG
날짜 일 차이 : DATEDIFF(날짜1, 날짜2)
테이블 선택 : FROM
그룹 : GROUP BY
그룹 조건 : HAVING
정렬 : ORDER BY
내림차순 : DESC

두 날짜간의 차이 + 1 을 해줘야 총 대여기간이 된다.
(ex. 시작일이 2023-02-10, 종료일이 2023-02-12 라면, 대여기간은 3일)
*/

SELECT CAR_ID, ROUND(AVG(DATEDIFF(END_DATE, START_DATE) + 1), 1) AS AVERAGE_DURATION
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
GROUP BY CAR_ID
HAVING AVERAGE_DURATION >= 7.0
ORDER BY AVERAGE_DURATION DESC, CAR_ID DESC
